<!-- Enhanced Navigation with Search and Dark Mode -->
<nav class="nav-enhanced fixed top-0 left-0 w-full z-50 py-3 px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between max-w-7xl mx-auto">
        <!-- Logo/Brand -->
        <div class="flex items-center space-x-3">
            <img src="/assets/eb-clean.jpg" alt="Ebrahim Khiyami" class="w-10 h-10 rounded-full object-cover border-2 border-gray-300">
            <div class="hidden sm:block">
                <span class="text-gray-900 font-bold text-lg">Ebrahim Khiyami</span>
                <div class="text-xs text-gray-500 font-medium">AWS Solutions Architect</div>
            </div>
        </div>
        
        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center space-x-1">
            <a href="/" class="nav-link-enhanced {% if page.url == '/' %}active{% endif %}">
                <i data-lucide="home" class="w-4 h-4"></i>
                Home
            </a>
            <a href="/abouttest/" class="nav-link-enhanced {% if page.url == '/abouttest/' %}active{% endif %}">
                <i data-lucide="user" class="w-4 h-4"></i>
                About
            </a>
            <a href="/abouttest/" class="nav-link-enhanced {% if page.url == '/abouttest/' %}active{% endif %}">
                <i data-lucide="test-tube" class="w-4 h-4"></i>
                AboutTest
            </a>
            <a href="/publications/" class="nav-link-enhanced {% if page.url == '/publications/' %}active{% endif %}">
                <i data-lucide="book-open" class="w-4 h-4"></i>
                Publications
            </a>
            <a href="/projects/" class="nav-link-enhanced {% if page.url == '/projects/' %}active{% endif %}">
                <i data-lucide="briefcase" class="w-4 h-4"></i>
                Projects
            </a>
            <a href="/mentoring/" class="nav-link-enhanced {% if page.url == '/mentoring/' %}active{% endif %}">
                <i data-lucide="users" class="w-4 h-4"></i>
                Mentoring
            </a>
        </div>
        
        <!-- Search & Actions -->
        <div class="hidden md:flex items-center space-x-3">
            <!-- Search Button -->
            <button id="search-btn" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                <i data-lucide="search" class="w-5 h-5 text-gray-600"></i>
            </button>
            
            <!-- Dark Mode Toggle -->
            <button id="theme-toggle" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                <i data-lucide="sun" class="w-5 h-5 text-gray-600 dark:hidden"></i>
                <i data-lucide="moon" class="w-5 h-5 text-gray-600 hidden dark:block"></i>
            </button>
            
            <!-- Contact CTA -->
            <a href="https://www.linkedin.com/in/eb-khiyami/" target="_blank" class="btn-primary text-sm px-4 py-2">
                <i data-lucide="linkedin" class="w-4 h-4"></i>
                Connect
            </a>
        </div>
        
        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="lg:hidden p-2 rounded-lg hover:bg-gray-100">
            <i data-lucide="menu" class="w-6 h-6"></i>
        </button>
    </div>
    
    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="hidden lg:hidden mt-4 pb-4 border-t border-gray-200">
        <div class="flex flex-col space-y-2 pt-4">
            <a href="/" class="nav-link-enhanced {% if page.url == '/' %}active{% endif %}">
                <i data-lucide="home" class="w-4 h-4"></i>
                Home
            </a>
            <a href="/abouttest/" class="nav-link-enhanced {% if page.url == '/abouttest/' %}active{% endif %}">
                <i data-lucide="user" class="w-4 h-4"></i>
                About
            </a>
            <a href="/abouttest/" class="nav-link-enhanced {% if page.url == '/abouttest/' %}active{% endif %}">
                <i data-lucide="test-tube" class="w-4 h-4"></i>
                AboutTest
            </a>
            <a href="/publications/" class="nav-link-enhanced {% if page.url == '/publications/' %}active{% endif %}">
                <i data-lucide="book-open" class="w-4 h-4"></i>
                Publications
            </a>
            <a href="/projects/" class="nav-link-enhanced {% if page.url == '/projects/' %}active{% endif %}">
                <i data-lucide="briefcase" class="w-4 h-4"></i>
                Projects
            </a>
            <a href="/mentoring/" class="nav-link-enhanced {% if page.url == '/mentoring/' %}active{% endif %}">
                <i data-lucide="users" class="w-4 h-4"></i>
                Mentoring
            </a>
            <div class="pt-4 border-t border-gray-200 mt-4">
                <a href="https://www.linkedin.com/in/eb-khiyami/" target="_blank" class="btn-primary w-full justify-center">
                    <i data-lucide="linkedin" class="w-4 h-4"></i>
                    Connect on LinkedIn
                </a>
            </div>
        </div>
    </div>
</nav>

<!-- Search Modal -->
<div id="search-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-start justify-center min-h-screen pt-20 px-4">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-2xl">
            <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">Search</h3>
                    <button id="close-search" class="p-2 hover:bg-gray-100 rounded-lg">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                <div class="relative">
                    <input 
                        type="text" 
                        id="search-input" 
                        placeholder="Search posts, projects, and content..." 
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                    <i data-lucide="search" class="absolute right-3 top-3.5 w-5 h-5 text-gray-400"></i>
                </div>
                <div id="search-results" class="mt-4 max-h-96 overflow-y-auto">
                    <!-- Search results will be populated here -->
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Enhanced Navigation JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Mobile menu toggle
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', function() {
            mobileMenu.classList.toggle('hidden');
        });
    }
    
    // Search modal
    const searchBtn = document.getElementById('search-btn');
    const searchModal = document.getElementById('search-modal');
    const closeSearch = document.getElementById('close-search');
    const searchInput = document.getElementById('search-input');
    
    if (searchBtn && searchModal) {
        searchBtn.addEventListener('click', function() {
            searchModal.classList.remove('hidden');
            searchInput.focus();
        });
    }
    
    if (closeSearch && searchModal) {
        closeSearch.addEventListener('click', function() {
            searchModal.classList.add('hidden');
        });
    }
    
    // Close search on escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !searchModal.classList.contains('hidden')) {
            searchModal.classList.add('hidden');
        }
    });
    
    // Dark mode toggle
    const themeToggle = document.getElementById('theme-toggle');
    
    if (themeToggle) {
        themeToggle.addEventListener('click', function() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        });
    }
    
    // Load saved theme
    if (localStorage.getItem('theme') === 'dark') {
        document.documentElement.classList.add('dark');
    }
    
    // Simple search functionality
    if (searchInput) {
        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase();
            const resultsContainer = document.getElementById('search-results');
            
            if (query.length < 2) {
                resultsContainer.innerHTML = '';
                return;
            }
            
            // Simple search implementation - you can enhance this with a proper search engine
            const searchableContent = [
                { title: 'About Me', url: '/about/', type: 'Page' },
                { title: 'AWS Well-Architected Review with Gen AI', url: '/wa-gen-ai/', type: 'Project' },
                { title: 'Chat with AWS Bill', url: '/chat-with-aws/', type: 'Solution' },
                { title: 'Video Chat with YouTube', url: '/video-chat/', type: 'Solution' },
                { title: 'Migration Lens Framework', url: '/migration-lens/', type: 'Publication' },
                { title: 'AWS Disaster Recovery Services', url: '/dr/', type: 'Solution' },
                { title: 'Mentoring Services', url: '/mentoring/', type: 'Service' }
            ];
            
            const results = searchableContent.filter(item => 
                item.title.toLowerCase().includes(query)
            );
            
            if (results.length > 0) {
                resultsContainer.innerHTML = results.map(result => `
                    <a href="${result.url}" class="block p-3 hover:bg-gray-50 rounded-lg border-b border-gray-100 last:border-b-0">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="font-medium text-gray-900">${result.title}</div>
                                <div class="text-sm text-gray-500">${result.type}</div>
                            </div>
                            <i data-lucide="arrow-right" class="w-4 h-4 text-gray-400"></i>
                        </div>
                    </a>
                `).join('');
                lucide.createIcons();
            } else {
                resultsContainer.innerHTML = '<div class="p-3 text-gray-500 text-center">No results found</div>';
            }
        });
    }
});
</script>

<!-- Include Search Script -->
<script src="/assets/js/search.js"></script>